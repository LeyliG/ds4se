▁/ ▁** ▁* ▁Class ▁that ▁implements ▁the ▁Agency ' s ▁Operator ▁* ▁* ▁@ ▁Auth or ▁J os eph ▁Mart one ▁* ▁@ ▁Version ▁0.1 ▁* ▁* ▁ © ▁ 2007 ▁eTour ▁Project ▁- ▁Copy right ▁by ▁DMI ▁SE ▁@ ▁ SA ▁Lab ▁- ▁University ▁of ▁Salerno ▁* ▁/ ▁p ackage ▁unisa . gps . etour . repository ; ▁import ▁Java . sql . Connection ; ▁import ▁java . sql . ResultSet ; ▁import ▁java . sql . SQLException ; ▁import ▁java . sql . Statement ; ▁import ▁unisa . gps . etour . bean . Bean OperatoreAgenzia ; ▁public ▁class ▁DB OperatoreAgenzia ▁implements ▁IDBOperatore Agenzia ▁( ▁/ ▁* ▁( Non - Java doc ) ▁* ▁@ ▁Se e ▁unisa . gps . etour . repository . IDB OperatoreAgenzia ▁# ▁ottieni OperatoreAgenzia ▁( int ) ▁* ▁/ ▁public ▁Bean OperatoreAgenzia ▁ottieni OperatoreAgenzia ▁( String ▁pUsername ) ▁throws ▁SQLException ▁( ▁/ ▁/ ▁Connect ▁to ▁database ▁Connection ▁conn ▁= ▁null ; ▁/ ▁/ ▁Statement ▁for ▁running ▁queries ▁Statement ▁stat ▁= ▁null ; ▁/ ▁/ ▁Resu t ▁set ▁whe re ▁the ▁output ▁of ▁the ▁query ▁is ▁inserted ▁ResultSet ▁result ▁= ▁null ; ▁/ ▁/ ▁ Try ▁block ▁which ▁performs ▁the ▁query ▁and ▁the ▁database ▁connection ▁TR Y ▁( ▁/ ▁/ ▁You ▁get ▁the ▁database ▁connection ▁from ▁the ▁pool ▁D BConnessionePool . ottieni Connessione ▁conn ▁= ▁(); ▁/ ▁/ ▁Create ▁the ▁statement ▁stat ▁= ▁conn . createStatement ▁(); ▁/ ▁/ ▁Query ▁String ▁query ▁= ▁" SELECT ▁* ▁FR OM ▁ operatoreagenzia ▁W HER E ▁Username ▁= ▁'" ▁P Username ▁+ ▁+ ▁" ▁'" ; ▁result ▁= ▁stat . executeQuery ▁( query ); ▁Or ▁Bean OperatoreAgenzia ▁= ▁null ; ▁if ▁( result . next ▁()) ▁( ▁/ ▁/ ▁Build ▁the ▁bean ▁whe n ▁the ▁query ▁returns ▁a ▁/ ▁/ ▁Value ▁/ ▁/ ▁Otherwise ▁will ▁return ▁null ▁or ▁Bean OperatoreAgenzia ▁= ▁new ▁(); ▁o a . setId ▁( result . getInt ▁( ▁" Id ") ); ▁o a . set Username ▁( result . getString ▁( ▁" Username ") ); ▁o a . setNome ▁( result . getString ▁( ▁" Name ") ); ▁o a . setCognome ▁( result . getString ▁( ▁" Name ") ); ▁o a . setPassword ▁( result . getString ▁( ▁" Password ") ); ▁) ▁or ▁return ; ▁) ▁/ ▁/ ▁Final ly ▁block ▁that ▁contains ▁the ▁i nstruction s ▁to ▁close ▁the ▁connections ▁/ ▁/ ▁H y ena s ▁run ▁in ▁any ▁case ▁finally ▁( ▁/ ▁/ ▁ This ▁closes ▁the ▁result ▁set ▁on ly ▁if ▁and ▁' the ▁query ▁was ▁made ▁if ▁( result ! ▁= ▁null ) ▁( ▁result . close ▁(); ▁) ▁/ ▁/ ▁ This ▁closes ▁the ▁if ▁statement ▁and ▁' opened ▁if ▁( stat ▁= ▁null ) ▁( ▁stat . close ▁(); ▁) ▁/ ▁/ ▁It ▁returns ▁the ▁connection ▁to ▁the ▁pool ▁if ▁and ▁' opened ▁if ▁( conn ! ▁= ▁null ) ▁( ▁D BConnessionePool . rilascia Connessione ▁( conn ); ▁) ▁) ▁) ▁/ ▁* ▁( Non - Java doc ) ▁* ▁@ ▁Se e ▁unisa . gps . etour . repository . IDB OperatoreAgenzia ▁# ▁modifica Password ▁( java . lang . String ) ▁* ▁/ ▁public ▁boolean ▁modifica Password ▁( Bean OperatoreAgenzia ▁p o a ) ▁throws ▁SQLException ▁( ▁/ ▁/ ▁Connect ▁to ▁database ▁Connection ▁conn ▁= ▁null ; ▁/ ▁/ ▁Statement ▁for ▁running ▁queries ▁Statement ▁stat ▁= ▁null ; ▁/ ▁/ ▁ Try ▁block ▁which ▁performs ▁the ▁query ▁and ▁the ▁database ▁connection ▁TR Y ▁( ▁/ ▁/ ▁You ▁get ▁the ▁database ▁connection ▁from ▁the ▁pool ▁D BConnessionePool . ottieni Connessione ▁conn ▁= ▁(); ▁/ ▁/ ▁Create ▁the ▁statement ▁stat ▁= ▁conn . createStatement ▁(); ▁/ ▁/ ▁Query ▁String ▁query ▁= ▁" UP DATE ▁ operatoreagenzia ▁SE T " ▁+ ▁" Password ▁= ▁'" ▁PO a . getPassword ▁+ ▁() ▁+ ▁" ▁' W HER E ▁Id ▁=" ▁+ ▁p O a . getId ▁(); ▁/ ▁/ ▁You ▁run ▁the ▁query ▁int ▁i ▁= ▁stat . executeUpdate ▁( query ); ▁return ▁( i ▁== ▁ 1); ▁) ▁/ ▁/ ▁Final ly ▁block ▁that ▁contains ▁the ▁i nstruction s ▁to ▁close ▁the ▁connections ▁/ ▁/ ▁H y ena s ▁run ▁in ▁any ▁case ▁finally ▁( ▁/ ▁/ ▁ This ▁closes ▁the ▁if ▁statement ▁and ▁' opened ▁if ▁( stat ▁= ▁null ) ▁( ▁stat . close ▁(); ▁) ▁/ ▁/ ▁It ▁returns ▁the ▁connection ▁to ▁the ▁pool ▁if ▁and ▁' opened ▁if ▁( conn ! ▁= ▁null ) ▁( ▁D BConnessionePool . rilascia Connessione ▁( conn ); ▁) ▁) ▁) ▁)