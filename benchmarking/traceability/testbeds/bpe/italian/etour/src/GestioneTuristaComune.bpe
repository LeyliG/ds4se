▁ ï»¿ p ackage ▁unisa . gps . etour . control . Gestione UtentiRegistrati ; ▁import ▁java . rmi . RemoteException ; ▁import ▁java . rmi . server . Uni castRemoteObject ; ▁import ▁java . sql . SQLException ; ▁import ▁unisa . gps . etour . bean . BeanTurista ; ▁import ▁unisa . gps . etour . repository . DBTurista ; ▁import ▁unisa . gps . etour . repository . IDBTurista ; ▁import ▁unisa . gps . etour . util . MessaggiErrore ; ▁/ ▁** ▁* ▁Class ▁that ▁implements ▁the ▁common ▁tasks ▁for ▁Operator s ▁and ▁Tourist ▁Agency ▁* ▁I e ▁modificaTurista ▁and ▁ottieniTurista ▁* ▁* ▁@ ▁Auth or ▁J os eph ▁Mo relli ▁* ▁@ ▁Version ▁0.1 ▁ 2007 ▁eTour ▁Project ▁- ▁Copy right ▁by ▁SE ▁@ ▁ SA ▁Lab ▁DMI ▁University ▁* ▁Of ▁Salerno ▁* ▁/ ▁Gestione TuristaComune ▁Uni castRemoteObject ▁public ▁class ▁ext ends ▁implements ▁IGestione TuristaComune ▁( ▁prot ected ▁IDBTurista ▁tourist ; ▁/ ▁/ ▁Constructor ▁that ▁ric h a ma ▁turn ▁the ▁class ▁constructor ▁/ ▁/ ▁Uni castRemoteObject ▁to ▁connect ▁via ▁RMI ▁/ ▁/ ▁Instantiate ▁and ▁connect ▁to ▁the ▁database ▁public ▁Gestione TuristaComune ▁() ▁throws ▁RemoteException ▁( ▁super ▁(); ▁/ ▁/ ▁Connect ▁to ▁the ▁Database ▁TR Y ▁( ▁Tourists ▁ DBTurista ▁= ▁new ▁(); ▁) ▁/ ▁/ ▁Exception ▁in ▁the ▁database ▁connection ▁catch ▁( Exception ▁e ) ▁( ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁) ▁/ ▁/ ▁Method ▁that ▁allow s ▁you ▁to ▁change ▁the ▁data ▁of ▁a ▁tourist ▁through ▁its ▁/ ▁/ ▁Data ▁public ▁boolean ▁modificaTurista ▁( BeanTurista ▁ pProfiloTurista ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁of ▁past ▁data ▁if ▁( ( pProfiloTurista ▁== ▁null ) ▁| ▁| ▁(! ▁( P Profil o Turista ▁instance of ▁BeanTurista ))) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁/ ▁/ ▁ Execution ▁of ▁the ▁amendment ▁TR Y ▁( ▁/ ▁/ ▁I f ▁the ▁changes ▁ were ▁made ▁returns ▁true ▁if ▁( turista . modificaTurista ▁( pProfiloTurista )) ▁return ▁true ; ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁catch ▁( SQLException ▁e ) ▁( ▁/ ▁/ ▁I f ▁the ▁data ▁layer ▁send s ▁an ▁exception ▁is ▁throws ▁the ▁exception ▁remote ▁System . out . println ▁( ▁" Error ▁in ▁method ▁modificaTurista " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exception ▁ca used ▁by ▁other ▁fa ctors ▁catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁modificaTurista " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁I f ▁there ▁ were ▁no ▁exceptions ▁but ▁the ▁changes ▁are ▁not ▁/ ▁/ ▁Return s ▁false ▁ were ▁made ▁return ▁false ; ▁) ▁/ ▁/ ▁Method ▁to ▁obtain ▁the ▁bean ▁with ▁data ▁from ▁the ▁Tourist ▁/ ▁/ ▁Identif i ed ▁by ▁/ ▁/ ▁The ▁parameter ▁passed ▁public ▁BeanTurista ▁ottieniTurista ▁( int ▁pIdTurista ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁identifier ▁if ▁( pIdTurista ▁<0) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁BeanTurista ▁toReturn ▁= ▁null , ▁/ ▁/ ▁variable ▁return ▁/ ▁/ ▁Re trieve ▁data ▁TR Y ▁( ▁/ ▁/ ▁Are ▁request ed ▁to ▁return ▁the ▁bean ▁layer ▁on ▁the ▁tourist ▁/ ▁/ ▁With ▁id ▁equal ▁to ▁pIdTurista ▁toReturn ▁= ▁turista . ottieniTurista ▁( pIdTurista ); ▁if ▁( null ▁== ▁toReturn ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁Exception ▁in ▁database ▁operations ▁catch ▁( SQLException ▁e ) ▁( ▁/ ▁/ ▁I f ▁the ▁data ▁layer ▁send s ▁an ▁exception ▁is ▁throws ▁the ▁exception ▁remote ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieniTurista " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁ca used ▁by ▁other ▁fa ctors ▁catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieniTurista " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁Return ▁the ▁result ▁toReturn ▁return ; ▁) ▁)