▁ REQUIRE MENT ▁13 : ▁ PROTOCOL ▁ DE SIGN ▁AND ▁LAYER ING ▁Figure ▁2 ▁provide s ▁an ▁ex p an s ion ▁of ▁Figure ▁1, ▁describ ing ▁how ▁the ▁layer s ▁are ▁used . ▁E ach ▁as p e ct ▁is ▁describe d ▁in ▁more ▁detail ▁in ▁the ▁section s ▁that ▁follow . ▁EST ▁Layer ing : ▁Protocols ▁and ▁uses : ▁+-------------- ---------------- ---------------- ------+ ▁| ▁| ▁| ▁Message ▁types : ▁| ▁| ▁- ▁" Simple ▁PKI " ▁messages ▁| ▁| ▁( incorporate s ▁p roof - of - possession ) ▁| ▁| ▁- ▁CA ▁certificate ▁retriev al ▁| ▁| ▁- ▁" Full ▁PKI " ▁messages ▁( OPTIONAL ) ▁| ▁| ▁( incorporate s ▁p roof - of - possession ) ▁| ▁| ▁- ▁CSR ▁Attributes ▁Request ▁( OPTIONAL ) ▁| ▁| ▁- ▁Server - generated ▁key ▁request ▁( OPTIONAL ) ▁| ▁| ▁| ▁+-------------- ---------------- ---------------- ------+ ▁| ▁| ▁| ▁HTTP : ▁| ▁| ▁- ▁HTTP ▁headers ▁and ▁URIs ▁for ▁control ▁| ▁| ▁- ▁Content - Type ▁headers ▁specify ▁message ▁type ▁| ▁| ▁- ▁ Header s ▁for ▁control / error ▁messages ▁| ▁| ▁- ▁URIs ▁for ▁select ing ▁functions ▁| ▁| ▁- ▁Basic ▁or ▁Digest ▁authentication ▁( OPTIONAL ) ▁| ▁| ▁| ▁+-------------- ---------------- ---------------- ------+ ▁| ▁| ▁| ▁TLS ▁for ▁transport ▁security : ▁| ▁| ▁- ▁Authentication ▁of ▁the ▁EST ▁server ▁| ▁| ▁- ▁Authentication ▁of ▁the ▁EST ▁client ▁( OPTIONAL ) ▁| ▁| ▁- ▁Provide s ▁communication s ▁in tegrity ▁| ▁| ▁and ▁confi dential ity ▁| ▁| ▁- ▁S up p li es ▁channel - binding ▁[ RFC 5929 ] ▁information ▁| ▁| ▁to ▁link ▁p roof - of - identity ▁with ▁message - based ▁| ▁| ▁p roof - of - possession ▁( OPTIONAL ) ▁| ▁| ▁| ▁+-------------- ---------------- ---------------- ------+ ▁Figure ▁2 ▁Specify ing ▁HTTP S ▁as ▁the ▁secure ▁transport ▁for ▁enrollment ▁messages ▁int ro d u c es ▁two ▁" layers " ▁to ▁communicate ▁authentication ▁and ▁control ▁messages : ▁TLS ▁and ▁HTTP . ▁The ▁TLS ▁layer ▁provide s ▁in tegrity ▁and ▁confi dential ity ▁dur ing ▁transport . ▁The ▁p roof - of - identity ▁is ▁suppl ied ▁by ▁TLS ▁handshake ▁authentication ▁and ▁optional ly ▁also ▁by ▁the ▁HTTP ▁layer ▁headers . ▁The ▁message ▁type ▁and ▁control / error ▁messages ▁are ▁included ▁in ▁the ▁HTTP ▁headers . ▁CMC ▁( [ RFC 5272 ] , ▁Section ▁3.1 ) ▁notes ▁that ▁" the ▁Simple ▁PKI ▁Request ▁MUST ▁NOT ▁be ▁used ▁if ▁a ▁p roof - of - identity ▁needs ▁to ▁be ▁included " . ▁S ince ▁the ▁TLS ▁and ▁HTTP ▁layer s ▁can ▁provide ▁p roof - of - identity ▁for ▁EST ▁clients ▁and ▁server s , ▁the ▁Simple ▁PKI ▁message ▁types ▁are ▁used . ▁The ▁TLS ▁layer ▁certificate ▁exchange ▁provide s ▁a ▁method ▁for ▁authoriz ing ▁client ▁enrollment ▁requests ▁using ▁existing ▁certificates . ▁S uch ▁certificates ▁ma y ▁have ▁been ▁issued ▁by ▁the ▁CA ▁( from ▁which ▁the ▁client ▁is ▁requesting ▁a ▁certificate ) , ▁or ▁they ▁ma y ▁have ▁been ▁issued ▁under ▁a ▁distinct ▁PKI ▁( e . g . , ▁an ▁IE E E ▁80 2.1 AR ▁Init ial ▁D ev ice ▁Identifier ▁( IDevID ) ▁[ IDevID ] ▁credential ) . ▁ Proof - of - possession ▁( POP ) ▁is ▁a ▁distinct ▁issue ▁from ▁p roof - of - identity ▁and ▁is ▁included ▁in ▁the ▁Simple ▁PKI ▁message ▁type ▁as ▁describe d ▁in ▁Section ▁3 . 4 . ▁A ▁method ▁of ▁link ing ▁p roof - of - identity ▁and ▁p roof - of - possession ▁is ▁describe d ▁in ▁Section ▁3.5 . ▁This ▁document ▁also ▁ define s ▁transport ▁for ▁CMC ▁[ RFC 5272 ] ▁that ▁compl ies ▁with ▁the ▁CMC ▁Transport ▁Protocols ▁[ RFC 5273 ] . ▁CMC ' s ▁ POP ▁and ▁p roof - of - identity ▁mechanism s ▁are ▁defined ▁in ▁CMC , ▁but ▁the ▁mechanism s ▁here ▁can ▁also ▁be ▁used ▁in ▁con j unction ▁with ▁ th ose ▁mechanism s ▁in ▁" Full ▁PKI " ▁messages . ▁Dur ing ▁protocol ▁exchange s , ▁different ▁certificates ▁can ▁be ▁used . ▁The ▁following ▁table ▁provide s ▁an ▁informati ve ▁over view . ▁End - ent it ies ▁can ▁have ▁one ▁or ▁more ▁certificates ▁of ▁ each ▁type ▁list ed ▁in ▁Figure ▁3 ▁and ▁use ▁one ▁or ▁more ▁trust ▁anchor ▁database s ▁of ▁ each ▁type ▁list ed ▁in ▁Figure ▁4 . ▁Certificates ▁and ▁the ir ▁correspond ing ▁uses : ▁+-------------- +-------------- ------+ ---------------- ---------------+ ▁| ▁Certificate ▁| ▁I s su er ▁| ▁Use ▁and ▁section ▁reference s ▁| ▁+============== + == == ================ += == == == == ================ ======+ ▁| ▁EST ▁server ▁| ▁The ▁CA ▁ served ▁by ▁| ▁P resented ▁by ▁the ▁EST ▁server ▁| ▁| ▁certificate ▁| ▁the ▁EST ▁server ▁| ▁dur ing ▁the ▁TLS ▁handshake . ▁| ▁| ▁| ▁| ▁| ▁| ▁| ▁| ▁Section ▁3.3.1 ▁| ▁+-------------- +-------------- ------+ ---------------- ---------------+ ▁| ▁EST ▁server ▁| ▁A ▁CA ▁| ▁P resented ▁by ▁the ▁EST ▁server ▁| ▁| ▁certificate ▁| ▁authenticat able ▁by ▁| ▁dur ing ▁the ▁TLS ▁handshake . ▁| ▁| ▁| ▁a ▁third - party ▁TA , ▁| ▁| ▁| ▁| ▁e . g . , ▁a ▁web ▁server ▁| ▁Section ▁3.3.1 ▁and ▁| ▁| ▁| ▁CA ▁| ▁Security ▁Considerations ▁| ▁+-------------- +-------------- ------+ ---------------- ---------------+ ▁| ▁Thi rd - party ▁| ▁A ▁CA ▁| ▁P resented ▁by ▁the ▁EST ▁client ▁| ▁| ▁EST ▁client ▁| ▁authenticat able ▁by ▁| ▁to ▁the ▁EST ▁server ▁by ▁clients ▁| ▁| ▁certificate ▁| ▁a ▁third - party ▁TA , ▁| ▁that ▁have ▁not ▁yet ▁enrolled . ▁| ▁| ▁| ▁e . g . , ▁a ▁devi ce ▁| ▁| ▁| ▁| ▁manufacturer ▁| ▁Section ▁3.3.2 ▁| ▁+-------------- +-------------- ------+ ---------------- ---------------+ ▁| ▁EST ▁client ▁| ▁The ▁CA ▁ served ▁by ▁| ▁P resented ▁to ▁the ▁EST ▁server ▁| ▁| ▁certificate ▁| ▁the ▁EST ▁server ▁| ▁dur ing ▁future ▁EST ▁operations . ▁| ▁| ▁| ▁| ▁| ▁| ▁| ▁| ▁Section ▁3.3.2 ▁| ▁+-------------- +-------------- ------+ ---------------- ---------------+ ▁| ▁End - entity ▁| ▁The ▁CA ▁ served ▁by ▁| ▁Clients ▁can ▁obtain ▁certs ▁| ▁| ▁certificate ▁| ▁the ▁EST ▁server ▁| ▁that ▁are ▁intended ▁for ▁| ▁| ▁| ▁| ▁non - EST ▁uses . ▁This ▁include s ▁| ▁| ▁| ▁| ▁certs ▁that ▁cannot ▁be ▁used ▁| ▁| ▁| ▁| ▁for ▁EST ▁operations . ▁| ▁| ▁| ▁| ▁| ▁| ▁| ▁| ▁Section ▁4.2.3 ▁| ▁+-------------- +-------------- ------+ ---------------- ---------------+ ▁Figure ▁3 ▁ Trust ▁anchor ▁database s ▁and ▁the ir ▁correspond ing ▁uses : ▁+-------------- +-------------- ---------------- ---------------- ------+ ▁| ▁TA ▁database ▁| ▁Use ▁and ▁section ▁reference s ▁| ▁+============== + == == ================ ================ ================ + ▁| ▁EST ▁server ▁| ▁EST ▁server s ▁use ▁this ▁TA ▁database ▁to ▁authenticate ▁| ▁| ▁Explicit ▁| ▁certificates ▁issued ▁by ▁the ▁EST ▁CA , ▁includ ing ▁EST ▁| ▁| ▁TA ▁database ▁| ▁client ▁certificates ▁dur ing ▁enroll / re - enroll ▁| ▁| ▁| ▁operations . ▁| ▁| ▁| ▁| ▁| ▁| ▁Section ▁3.3.2 ▁| ▁+-------------- +-------------- ---------------- ---------------- ------+ ▁| ▁EST ▁server ▁| ▁EST ▁server s ▁use ▁this ▁TA ▁database ▁to ▁authenticate ▁| ▁| ▁ Implicit ▁| ▁certificates ▁issued ▁by ▁third - party ▁TAs ; ▁| ▁| ▁TA ▁database ▁| ▁e . g . , ▁EST ▁client ▁certificates ▁issued ▁by ▁a ▁devi ce ▁| ▁| ▁| ▁manufacturer . ▁| ▁| ▁| ▁An ▁ Implicit ▁TA ▁database ▁can ▁be ▁disabled . ▁| ▁| ▁| ▁| ▁| ▁| ▁Section ▁3.3.2 ▁| ▁+-------------- +-------------- ---------------- ---------------- ------+ ▁| ▁EST ▁client ▁| ▁EST ▁clients ▁use ▁this ▁TA ▁database ▁to ▁authenticate ▁| ▁| ▁Explicit ▁| ▁certificates ▁issued ▁by ▁the ▁EST ▁CA , ▁includ ing ▁EST ▁| ▁| ▁TA ▁database ▁| ▁server ▁certificates . ▁| ▁| ▁| ▁| ▁| ▁| ▁Section s ▁3.1 , ▁3.3.1 , ▁3.6.1 , ▁and ▁4.1.1 ▁| ▁+-------------- +-------------- ---------------- ---------------- ------+ ▁| ▁EST ▁client ▁| ▁EST ▁clients ▁use ▁this ▁TA ▁database ▁to ▁| ▁| ▁ Implicit ▁| ▁authenticate ▁an ▁EST ▁server ▁that ▁uses ▁an ▁external ly ▁| ▁| ▁TA ▁database ▁| ▁issued ▁certificate . ▁| ▁| ▁| ▁An ▁ Implicit ▁TA ▁database ▁can ▁be ▁disabled . ▁| ▁| ▁| ▁| ▁| ▁| ▁Section s ▁3.1 , ▁3.3.1 , ▁3.6.2 , ▁and ▁| ▁| ▁| ▁Security ▁Considerations ▁| ▁+-------------- +-------------- ---------------- ---------------- ------+ ▁Figure ▁4