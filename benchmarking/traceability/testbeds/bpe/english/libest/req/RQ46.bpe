▁ REQUIRE MENT ▁ 46: ▁ SERVER - SI DE ▁ KEY ▁GENERATION ▁ RESPONSE ▁If ▁the ▁request ▁is ▁successful , ▁the ▁server ▁response ▁MUST ▁have ▁an ▁HTTP ▁200 ▁response ▁code ▁with ▁a ▁content - type ▁of ▁" mu ltip art / mixed " ▁con sis ting ▁of ▁two ▁part s : ▁one ▁part ▁is ▁the ▁private ▁key ▁data ▁and ▁the ▁other ▁part ▁is ▁the ▁certificate ▁data . ▁The ▁format ▁in ▁which ▁the ▁private ▁key ▁data ▁part ▁is ▁returned ▁is ▁depend ent ▁on ▁whether ▁the ▁private ▁key ▁is ▁being ▁returned ▁with ▁additional ▁encryption ▁on ▁to p ▁of ▁that ▁provided ▁by ▁TLS . ▁If ▁additional ▁encryption ▁is ▁not ▁being ▁employed , ▁the ▁private ▁key ▁data ▁MUST ▁be ▁placed ▁in ▁an ▁" application / pkcs 8 " . ▁An ▁" application / pkcs 8 " ▁part ▁con sis t s ▁of ▁the ▁base 64 - encoded ▁DER - encoded ▁[ X .690 ] ▁ PrivateKey Info ▁with ▁a ▁Content - Transfer - Encoding ▁of ▁" base 64" ▁[ RFC 2045 ] . ▁If ▁additional ▁encryption ▁is ▁being ▁employed , ▁the ▁private ▁key ▁is ▁placed ▁in side ▁of ▁a ▁CMS ▁SignedData . ▁The ▁SignedData ▁is ▁signed ▁by ▁the ▁party ▁that ▁generated ▁the ▁private ▁key , ▁which ▁ma y ▁or ▁ma y ▁not ▁be ▁the ▁EST ▁server ▁or ▁the ▁EST ▁CA . ▁The ▁SignedData ▁is ▁f ur ther ▁ protected ▁by ▁p la c ing ▁it ▁in side ▁of ▁a ▁CMS ▁EnvelopedData , ▁as ▁describe d ▁in ▁Section ▁4 ▁of ▁[ RFC 5958 ] . ▁The ▁following ▁list ▁show s ▁how ▁the ▁E nc ry pt ed Data ▁is ▁used , ▁depend ing ▁on ▁the ▁type ▁of ▁protection ▁key ▁specified ▁by ▁the ▁client . ▁If ▁the ▁client ▁specified ▁a ▁ symmetric ▁encryption ▁key ▁to ▁protect ▁the ▁server - generated ▁private ▁key , ▁the ▁EnvelopedData ▁content ▁is ▁encrypted ▁using ▁the ▁secret ▁key ▁identifi ed ▁in ▁the ▁request . ▁The ▁EnvelopedData ▁ RecipientInfo ▁field ▁MUST ▁indicate ▁the ▁key - enc ry p tion ▁k e k ri ▁key ▁manage ment ▁techni que . ▁The ▁values ▁are ▁as ▁follow s : ▁version ▁is ▁set ▁to ▁4 , ▁key - enc ry p tion ▁key ▁identifier ▁( k e k id ) ▁is ▁set ▁to ▁the ▁value ▁of ▁the ▁ DecryptKeyI dentifier ▁from ▁Section ▁4.4.1. 1 ; ▁key Encryption Algorithm ▁is ▁set ▁to ▁one ▁of ▁the ▁key ▁wrap ▁algorithm s ▁that ▁the ▁client ▁included ▁in ▁the ▁S MIME C apabilities ▁acc ompany ing ▁the ▁request ; ▁and ▁encrypted Key ▁is ▁the ▁encrypted ▁key . ▁If ▁the ▁client ▁specified ▁an ▁asymmetric ▁encryption ▁key ▁suit able ▁for ▁key ▁transport ▁operations ▁to ▁protect ▁the ▁server - generated ▁private ▁key , ▁the ▁EnvelopedData ▁content ▁is ▁encrypted ▁using ▁a ▁randomly ▁generated ▁ symmetric ▁encryption ▁key . ▁The ▁crypto graph ic ▁strength ▁of ▁the ▁ symmetric ▁encryption ▁key ▁SHOULD ▁be ▁ equiv a len t ▁to ▁the ▁client - ▁specified ▁asymmetric ▁key . ▁The ▁EnvelopedData ▁ RecipientInfo ▁field ▁MUST ▁indicate ▁the ▁Key T ra n s RecipientInfo ▁( k tr i ) ▁key ▁manage ment ▁techni que . ▁In ▁Key T ra n s RecipientInfo , ▁the ▁Re c ip i ent Identifier ▁( r id ) ▁is ▁e i ther ▁the ▁subject Key Identifier ▁copied ▁from ▁the ▁attribute ▁defined ▁in ▁Section ▁4.4.1. 2 ▁or ▁the ▁server ▁determine s ▁an ▁associate d ▁issue r AndS erialNumber ▁from ▁the ▁attribute ; ▁version ▁is ▁der ive d ▁from ▁the ▁cho ice ▁of ▁rid ▁[ RFC 5652 ] , ▁key Encryption Algorithm ▁is ▁set ▁to ▁one ▁of ▁the ▁key ▁wrap ▁algorithm s ▁that ▁the ▁client ▁included ▁in ▁the ▁S MIME C apabilities ▁acc ompany ing ▁the ▁request , ▁and ▁encrypted Key ▁is ▁the ▁encrypted ▁key . ▁If ▁the ▁client ▁specified ▁an ▁asymmetric ▁encryption ▁key ▁suit able ▁for ▁key ▁a gre e ment ▁operations ▁to ▁protect ▁the ▁server - generated ▁private ▁key , ▁the ▁EnvelopedData ▁content ▁is ▁encrypted ▁using ▁a ▁randomly ▁generated ▁ symmetric ▁encryption ▁key . ▁The ▁crypto graph ic ▁strength ▁of ▁the ▁ symmetric ▁encryption ▁key ▁SHOULD ▁be ▁ equiv a len t ▁to ▁the ▁client - ▁specified ▁asymmetric ▁key . ▁The ▁EnvelopedData ▁ RecipientInfo ▁field ▁MUST ▁indicate ▁the ▁Key Agree RecipientInfo ▁( ka ri ) ▁key ▁manage ment ▁techni que . ▁In ▁the ▁Key Agree RecipientInfo ▁type , ▁version , ▁origin at or , ▁and ▁user ▁key ing ▁ma ter ial ▁( u km ) ▁are ▁as ▁in ▁[ RFC 5652 ] , ▁and ▁key Encryption Algorithm ▁is ▁set ▁to ▁one ▁of ▁the ▁key ▁wrap ▁algorithm s ▁that ▁the ▁client ▁included ▁in ▁the ▁S MIME C apabilities ▁acc ompany ing ▁the ▁request . ▁The ▁recipient ' s ▁key ▁identifier ▁is ▁e i ther ▁copied ▁from ▁the ▁attribute ▁defined ▁in ▁Section ▁4.4.1. 2 ▁to ▁subject Key Identifier ▁or ▁the ▁server ▁determine s ▁an ▁I s su er AndS erialNumber ▁that ▁correspond s ▁to ▁the ▁value ▁provided ▁in ▁the ▁attribute . ▁In ▁all ▁thre e ▁additional ▁encryption ▁cases , ▁the ▁EnvelopedData ▁is ▁returned ▁in ▁the ▁response ▁as ▁an ▁" application / pkcs 7- mime " ▁part ▁with ▁an ▁ s mime - type ▁parameter ▁of ▁" server - generated - key " ▁and ▁a ▁Content - ▁ Transfer - Encoding ▁of ▁" base 64" . ▁The ▁certificate ▁data ▁part ▁is ▁an ▁" application / pkcs 7- mime " ▁and ▁exact ly ▁matches ▁the ▁certificate ▁response ▁to ▁/ simpleenroll . ▁When ▁reject ing ▁a ▁request , ▁the ▁server ▁MUST ▁specify ▁e i ther ▁an ▁HTTP ▁4 xx ▁error ▁or ▁an ▁HTTP ▁5 xx ▁error . ▁If ▁the ▁content - type ▁is ▁not ▁set , ▁the ▁response ▁data ▁MUST ▁be ▁a ▁ plain text ▁human - readable ▁error ▁message .